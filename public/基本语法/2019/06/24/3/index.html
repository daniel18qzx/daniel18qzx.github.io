<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-cn">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">






















<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.7.0">

<link rel="stylesheet" href="/css/main.css?v=7.1.2">



  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.1.2">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.1.2">








<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.1.2',
    sidebar: {"position":"left","display":"post","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: true,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="基本设置1pd.set_option(&quot;max_columns&quot;, 50)  数据缺失检查123apts=pd.Series([&quot;Hangzhou&quot;, &quot;Beijing&quot;, &quot;Shenzhen&quot;])print(apts.notnull())print(apts.isnull())  0    True 1    True 2    True dtype: bool 0    False 1">
<meta property="og:type" content="article">
<meta property="og:title" content="Pandas基本语法">
<meta property="og:url" content="https://daniel18qzx.github.io/基本语法/2019/06/24/3/index.html">
<meta property="og:site_name" content="菜鸟分析狮">
<meta property="og:description" content="基本设置1pd.set_option(&quot;max_columns&quot;, 50)  数据缺失检查123apts=pd.Series([&quot;Hangzhou&quot;, &quot;Beijing&quot;, &quot;Shenzhen&quot;])print(apts.notnull())print(apts.isnull())  0    True 1    True 2    True dtype: bool 0    False 1">
<meta property="og:locale" content="zh-cn">
<meta property="og:updated_time" content="2019-06-27T16:46:19.735Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Pandas基本语法">
<meta name="twitter:description" content="基本设置1pd.set_option(&quot;max_columns&quot;, 50)  数据缺失检查123apts=pd.Series([&quot;Hangzhou&quot;, &quot;Beijing&quot;, &quot;Shenzhen&quot;])print(apts.notnull())print(apts.isnull())  0    True 1    True 2    True dtype: bool 0    False 1">





  
  
  <link rel="canonical" href="https://daniel18qzx.github.io/基本语法/2019/06/24/3/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Pandas基本语法 | 菜鸟分析狮</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-cn">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">菜鸟分析狮</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">没有难处理的数据，没有难写的报告</h1>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-homemenu"></i> <br>Home</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>Search</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="Searching..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://daniel18qzx.github.io/基本语法/2019/06/24/3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Dan">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="菜鸟分析狮">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Pandas基本语法

              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2019-06-24 00:00:00" itemprop="dateCreated datePublished" datetime="2019-06-24T00:00:00+08:00">2019-06-24</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Edited on</span>
                
                <time title="Modified: 2019-06-28 00:46:19" itemprop="dateModified" datetime="2019-06-28T00:46:19+08:00">2019-06-28</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/基本语法/" itemprop="url" rel="index"><span itemprop="name">基本语法</span></a></span>

                
                
              
            </span>
          

          
            
            
              
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
            
                <span class="post-meta-item-text">Comments: </span>
                <a href="/基本语法/2019/06/24/3/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count gitment-comments-count" data-xid="/基本语法/2019/06/24/3/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             Views:  
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          
            <div class="post-symbolscount">
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Symbols count in article: </span>
                
                <span title="Symbols count in article">15k</span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">25 mins.</span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="基本设置"><a href="#基本设置" class="headerlink" title="基本设置"></a>基本设置</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pd.set_option(<span class="string">"max_columns"</span>, <span class="number">50</span>)</span><br></pre></td></tr></table></figure>

<h2 id="数据缺失检查"><a href="#数据缺失检查" class="headerlink" title="数据缺失检查"></a>数据缺失检查</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">apts=pd.Series([<span class="string">"Hangzhou"</span>, <span class="string">"Beijing"</span>, <span class="string">"Shenzhen"</span>])</span><br><span class="line">print(apts.notnull())</span><br><span class="line">print(apts.isnull())</span><br></pre></td></tr></table></figure>

<pre><code>0    True
1    True
2    True
dtype: bool
0    False
1    False
2    False
dtype: bool</code></pre><h2 id="Series"><a href="#Series" class="headerlink" title="Series"></a>Series</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*- </span></span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===用数组生成Series==="</span>)</span><br><span class="line">obj = Series([<span class="number">4</span>, <span class="number">7</span>, <span class="number">-5</span>, <span class="number">3</span>])</span><br><span class="line">print(obj)</span><br><span class="line">print(obj.values)</span><br><span class="line">print(obj.index)</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===指定Series的index==="</span>)</span><br><span class="line">obj2 = Series([<span class="number">4</span>, <span class="number">7</span>, <span class="number">-5</span>, <span class="number">3</span>], index = [<span class="string">'d'</span>, <span class="string">'b'</span>, <span class="string">'a'</span>, <span class="string">'c'</span>])</span><br><span class="line">print(obj2)</span><br><span class="line">print(obj2.index)</span><br><span class="line">print(obj2[<span class="string">'a'</span>])</span><br><span class="line">obj2[<span class="string">'d'</span>] = <span class="number">6</span></span><br><span class="line">print(obj2[[<span class="string">'c'</span>, <span class="string">'a'</span>, <span class="string">'d'</span>]])</span><br><span class="line">print(obj2[obj2 &gt; <span class="number">0</span>])  <span class="comment"># 找出大于0的元素</span></span><br><span class="line">print(<span class="string">'b'</span> <span class="keyword">in</span> obj2) <span class="comment"># 判断索引是否存在</span></span><br><span class="line">print(<span class="string">'e'</span> <span class="keyword">in</span> obj2)</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===使用字典生成Series==="</span>)</span><br><span class="line">sdata = &#123;<span class="string">'Ohio'</span>:<span class="number">45000</span>, <span class="string">'Texas'</span>:<span class="number">71000</span>, <span class="string">'Oregon'</span>:<span class="number">16000</span>, <span class="string">'Utah'</span>:<span class="number">5000</span>&#125;</span><br><span class="line">obj3 = Series(sdata)</span><br><span class="line">print(obj3)</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===使用字典生成Series，并额外指定index，不匹配部分为NaN==="</span>)</span><br><span class="line">states = [<span class="string">'California'</span>, <span class="string">'Ohio'</span>, <span class="string">'Oregon'</span>, <span class="string">'Texas'</span>]</span><br><span class="line">obj4 = Series(sdata, index = states)</span><br><span class="line">print(obj4)</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===Series相加，相同索引部分相加==="</span>)</span><br><span class="line">print(obj3 + obj4)</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===指定Series及其索引的名字==="</span>)</span><br><span class="line">obj4.name = <span class="string">'population'</span></span><br><span class="line">obj4.index.name = <span class="string">'state'</span></span><br><span class="line">print( obj4)</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===替换index==="</span>)</span><br><span class="line">obj.index = [<span class="string">'Bob'</span>, <span class="string">'Steve'</span>, <span class="string">'Jeff'</span>, <span class="string">'Ryan'</span>]</span><br><span class="line">print(obj)</span><br></pre></td></tr></table></figure>

<pre><code>===用数组生成Series===
0    4
1    7
2   -5
3    3
dtype: int64
[ 4  7 -5  3]
RangeIndex(start=0, stop=4, step=1)

===指定Series的index===
d    4
b    7
a   -5
c    3
dtype: int64
Index([&apos;d&apos;, &apos;b&apos;, &apos;a&apos;, &apos;c&apos;], dtype=&apos;object&apos;)
-5
c    3
a   -5
d    6
dtype: int64
d    6
b    7
c    3
dtype: int64
True
False

===使用字典生成Series===
Ohio      45000
Texas     71000
Oregon    16000
Utah       5000
dtype: int64

===使用字典生成Series，并额外指定index，不匹配部分为NaN===
California        NaN
Ohio          45000.0
Oregon        16000.0
Texas         71000.0
dtype: float64

===Series相加，相同索引部分相加===
California         NaN
Ohio           90000.0
Oregon         32000.0
Texas         142000.0
Utah               NaN
dtype: float64

===指定Series及其索引的名字===
state
California        NaN
Ohio          45000.0
Oregon        16000.0
Texas         71000.0
Name: population, dtype: float64

===替换index===
Bob      4
Steve    7
Jeff    -5
Ryan     3
dtype: int64</code></pre><h2 id="填充"><a href="#填充" class="headerlink" title="填充"></a>填充</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*- </span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> nan <span class="keyword">as</span> NA</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series, DataFrame, Index</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===填充0==="</span>)</span><br><span class="line">df = DataFrame(np.random.randn(<span class="number">7</span>, <span class="number">3</span>))</span><br><span class="line">df.iloc[:<span class="number">4</span>, <span class="number">1</span>] = NA</span><br><span class="line">df.iloc[:<span class="number">2</span>, <span class="number">2</span>] = NA</span><br><span class="line">print(df.fillna(<span class="number">0</span>))</span><br><span class="line">df.fillna(<span class="number">0</span>, inplace = <span class="literal">True</span>)</span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===不同行列填充不同的值==="</span>)</span><br><span class="line">print(df.fillna(&#123;<span class="number">1</span>:<span class="number">0.5</span>, <span class="number">3</span>:<span class="number">-1</span>&#125;))  <span class="comment"># 第3列不存在</span></span><br><span class="line">print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===不同的填充方式==="</span>)</span><br><span class="line">df = DataFrame(np.random.randn(<span class="number">6</span>, <span class="number">3</span>))</span><br><span class="line">df.iloc[<span class="number">2</span>:, <span class="number">1</span>] = NA</span><br><span class="line">df.iloc[<span class="number">4</span>:, <span class="number">2</span>] = NA</span><br><span class="line">print(df)</span><br><span class="line">print(df.fillna(method = <span class="string">'ffill'</span>))</span><br><span class="line">print(df.fillna(method = <span class="string">'ffill'</span>, limit = <span class="number">2</span>))</span><br><span class="line">print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===用统计数据填充==="</span>)</span><br><span class="line">data = Series([<span class="number">1.</span>, NA, <span class="number">3.5</span>, NA, <span class="number">7</span>])</span><br><span class="line">print(data.fillna(data.mean()))</span><br></pre></td></tr></table></figure>

<pre><code>===填充0===
          0         1         2
0  0.619043  0.000000  0.000000
1  1.262121  0.000000  0.000000
2 -0.536828  0.000000  1.354608
3  0.273867  0.000000  1.046143
4  0.648504  0.366829 -0.122517
5  0.773085 -0.547392 -0.289962
6  0.070365 -1.258029  0.144977
          0         1         2
0  0.619043  0.000000  0.000000
1  1.262121  0.000000  0.000000
2 -0.536828  0.000000  1.354608
3  0.273867  0.000000  1.046143
4  0.648504  0.366829 -0.122517
5  0.773085 -0.547392 -0.289962
6  0.070365 -1.258029  0.144977

===不同行列填充不同的值===
          0         1         2
0  0.619043  0.000000  0.000000
1  1.262121  0.000000  0.000000
2 -0.536828  0.000000  1.354608
3  0.273867  0.000000  1.046143
4  0.648504  0.366829 -0.122517
5  0.773085 -0.547392 -0.289962
6  0.070365 -1.258029  0.144977

===不同的填充方式===
          0         1         2
0  0.755876  1.438577  0.986349
1  0.457114 -0.435046 -0.365518
2  0.631733       NaN  1.537871
3  1.217393       NaN  0.636592
4 -1.095912       NaN       NaN
5 -1.314859       NaN       NaN
          0         1         2
0  0.755876  1.438577  0.986349
1  0.457114 -0.435046 -0.365518
2  0.631733 -0.435046  1.537871
3  1.217393 -0.435046  0.636592
4 -1.095912 -0.435046  0.636592
5 -1.314859 -0.435046  0.636592
          0         1         2
0  0.755876  1.438577  0.986349
1  0.457114 -0.435046 -0.365518
2  0.631733 -0.435046  1.537871
3  1.217393 -0.435046  0.636592
4 -1.095912       NaN  0.636592
5 -1.314859       NaN  0.636592

===用统计数据填充===
0    1.000000
1    3.833333
2    3.500000
3    3.833333
4    7.000000
dtype: float64</code></pre><h2 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*- </span></span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series, DataFrame</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===指定索引，在列中指定不存在的列，默认数据用NaN==="</span>)</span><br><span class="line">frame2 = DataFrame(data,</span><br><span class="line">                    columns = [<span class="string">'year'</span>, <span class="string">'state'</span>, <span class="string">'pop'</span>, <span class="string">'debt'</span>],</span><br><span class="line">                    index = [<span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>, <span class="string">'five'</span>])</span><br><span class="line">print(frame2)</span><br><span class="line">print(frame2[<span class="string">'state'</span>])</span><br><span class="line">print(frame2.year)</span><br><span class="line">print(frame2.loc[<span class="string">'three'</span>])</span><br><span class="line">frame2[<span class="string">'debt'</span>] = <span class="number">16.5</span> <span class="comment"># 修改一整列</span></span><br><span class="line">print(frame2)</span><br><span class="line">frame2.debt = np.arange(<span class="number">5</span>)  <span class="comment"># 用numpy数组修改元素</span></span><br><span class="line">print(frame2)</span><br><span class="line">print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===用Series指定要修改的索引及其对应的值，没有指定的默认数据用NaN==="</span>)</span><br><span class="line">val = Series([<span class="number">-1.2</span>, <span class="number">-1.5</span>, <span class="number">-1.7</span>], index = [<span class="string">'two'</span>, <span class="string">'four'</span>, <span class="string">'five'</span>])</span><br><span class="line">frame2[<span class="string">'debt'</span>] = val</span><br><span class="line">print(frame2)</span><br><span class="line">print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===赋值给新列==="</span>)</span><br><span class="line">frame2[<span class="string">'eastern'</span>] = (frame2.state == <span class="string">'Ohio'</span>)  <span class="comment"># 如果state等于Ohio为True</span></span><br><span class="line">print(frame2)</span><br><span class="line">print(frame2.columns)</span><br><span class="line">print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===DataFrame转置==="</span>)</span><br><span class="line">pop = &#123;<span class="string">'Nevada'</span>:&#123;<span class="number">2001</span>:<span class="number">2.4</span>, <span class="number">2002</span>:<span class="number">2.9</span>&#125;,</span><br><span class="line">        <span class="string">'Ohio'</span>:&#123;<span class="number">2000</span>:<span class="number">1.5</span>, <span class="number">2001</span>:<span class="number">1.7</span>, <span class="number">2002</span>:<span class="number">3.6</span>&#125;&#125;</span><br><span class="line">frame3 = DataFrame(pop)</span><br><span class="line">print(frame3)</span><br><span class="line">print(frame3.T)</span><br><span class="line">print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===指定索引顺序，以及使用切片初始化数据==="</span>)</span><br><span class="line">print(DataFrame(pop))</span><br><span class="line">pdata = &#123;<span class="string">'Ohio'</span>:frame3[<span class="string">'Ohio'</span>][:<span class="number">-1</span>], <span class="string">'Nevada'</span>:frame3[<span class="string">'Nevada'</span>][:<span class="number">2</span>]&#125;</span><br><span class="line">print(DataFrame(pdata))</span><br><span class="line">print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===指定索引和列的名称==="</span>)</span><br><span class="line">frame3.index.name = <span class="string">'year'</span></span><br><span class="line">frame3.columns.name = <span class="string">'state'</span></span><br><span class="line">print(frame3)</span><br><span class="line">print(frame3.values)</span><br><span class="line">print(frame2.values)</span><br><span class="line">print(<span class="string">''</span>)</span><br><span class="line"></span><br><span class="line">print(<span class="string">"===stack==="</span>)</span><br><span class="line">print(frame3.stack())</span><br></pre></td></tr></table></figure>

<pre><code>===指定索引，在列中指定不存在的列，默认数据用NaN===
       year   state  pop debt
one    2000    Ohio  1.5  NaN
two    2001    Ohio  1.7  NaN
three  2002    Ohio  3.6  NaN
four   2001  Nevada  2.4  NaN
five   2002  Nevada  2.9  NaN
one        Ohio
two        Ohio
three      Ohio
four     Nevada
five     Nevada
Name: state, dtype: object
one      2000
two      2001
three    2002
four     2001
five     2002
Name: year, dtype: int64
year     2002
state    Ohio
pop       3.6
debt      NaN
Name: three, dtype: object
       year   state  pop  debt
one    2000    Ohio  1.5  16.5
two    2001    Ohio  1.7  16.5
three  2002    Ohio  3.6  16.5
four   2001  Nevada  2.4  16.5
five   2002  Nevada  2.9  16.5
       year   state  pop  debt
one    2000    Ohio  1.5     0
two    2001    Ohio  1.7     1
three  2002    Ohio  3.6     2
four   2001  Nevada  2.4     3
five   2002  Nevada  2.9     4

===用Series指定要修改的索引及其对应的值，没有指定的默认数据用NaN===
       year   state  pop  debt
one    2000    Ohio  1.5   NaN
two    2001    Ohio  1.7  -1.2
three  2002    Ohio  3.6   NaN
four   2001  Nevada  2.4  -1.5
five   2002  Nevada  2.9  -1.7

===赋值给新列===
       year   state  pop  debt  eastern
one    2000    Ohio  1.5   NaN     True
two    2001    Ohio  1.7  -1.2     True
three  2002    Ohio  3.6   NaN     True
four   2001  Nevada  2.4  -1.5    False
five   2002  Nevada  2.9  -1.7    False
Index([&apos;year&apos;, &apos;state&apos;, &apos;pop&apos;, &apos;debt&apos;, &apos;eastern&apos;], dtype=&apos;object&apos;)

===DataFrame转置===
      Nevada  Ohio
2000     NaN   1.5
2001     2.4   1.7
2002     2.9   3.6
        2000  2001  2002
Nevada   NaN   2.4   2.9
Ohio     1.5   1.7   3.6

===指定索引顺序，以及使用切片初始化数据===
      Nevada  Ohio
2000     NaN   1.5
2001     2.4   1.7
2002     2.9   3.6
      Ohio  Nevada
2000   1.5     NaN
2001   1.7     2.4

===指定索引和列的名称===
state  Nevada  Ohio
year               
2000      NaN   1.5
2001      2.4   1.7
2002      2.9   3.6
[[nan 1.5]
 [2.4 1.7]
 [2.9 3.6]]
[[2000 &apos;Ohio&apos; 1.5 nan True]
 [2001 &apos;Ohio&apos; 1.7 -1.2 True]
 [2002 &apos;Ohio&apos; 3.6 nan True]
 [2001 &apos;Nevada&apos; 2.4 -1.5 False]
 [2002 &apos;Nevada&apos; 2.9 -1.7 False]]

===stack===
year  state 
2000  Ohio      1.5
2001  Nevada    2.4
      Ohio      1.7
2002  Nevada    2.9
      Ohio      3.6
dtype: float64</code></pre><h2 id="Append-Join和Concatenate"><a href="#Append-Join和Concatenate" class="headerlink" title="Append, Join和Concatenate"></a>Append, Join和Concatenate</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(&#123;<span class="string">'apts'</span>: [<span class="number">55000</span>, <span class="number">60000</span>],</span><br><span class="line">                   <span class="string">'cars'</span>: [<span class="number">200000</span>, <span class="number">300000</span>],&#125;,</span><br><span class="line">                  index = [<span class="string">'Shanghai'</span>, <span class="string">'Beijing'</span>])</span><br><span class="line">df2 = pd.DataFrame(&#123;<span class="string">'apts'</span>: [<span class="number">25000</span>, <span class="number">20000</span>],</span><br><span class="line">                   <span class="string">'cars'</span>: [<span class="number">150000</span>, <span class="number">120000</span>],&#125;,</span><br><span class="line">                  index = [<span class="string">'Hangzhou'</span>, <span class="string">'Najing'</span>])</span><br><span class="line">df3 = pd.DataFrame(&#123;<span class="string">'apts'</span>: [<span class="number">30000</span>, <span class="number">10000</span>],</span><br><span class="line">                   <span class="string">'cars'</span>: [<span class="number">180000</span>, <span class="number">100000</span>],&#125;,</span><br><span class="line">                  index = [<span class="string">'Guangzhou'</span>, <span class="string">'Chongqing'</span>])</span><br><span class="line">df4 = pd.DataFrame(&#123;<span class="string">'salaries'</span>: [<span class="number">10000</span>, <span class="number">30000</span>, <span class="number">30000</span>, <span class="number">20000</span>, <span class="number">15000</span>],</span><br><span class="line">                  <span class="string">'cities'</span>: [<span class="string">'Suzhou'</span>, <span class="string">'Beijing'</span>, <span class="string">'Shanghai'</span>, <span class="string">'Guangzhou'</span>, <span class="string">'Tianjin'</span>]&#125;)</span><br><span class="line">print(df1)</span><br><span class="line">print(df2)</span><br><span class="line">print(df3)</span><br><span class="line">print(df4)</span><br></pre></td></tr></table></figure>

<pre><code>           apts    cars
Shanghai  55000  200000
Beijing   60000  300000
           apts    cars
Hangzhou  25000  150000
Najing    20000  120000
            apts    cars
Guangzhou  30000  180000
Chongqing  10000  100000
   salaries     cities
0     10000     Suzhou
1     30000    Beijing
2     30000   Shanghai
3     20000  Guangzhou
4     15000    Tianjin</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"===concat==="</span>)</span><br><span class="line">frames = [df1, df2, df3]</span><br><span class="line">result = pd.concat(frames)</span><br><span class="line">print(result)</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line">result2 = pd.concat(frames, keys=[<span class="string">'x'</span>, <span class="string">'y'</span>, <span class="string">'z'</span>])</span><br><span class="line">print(result2)</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line">print(pd.concat([df1, df2], axis=<span class="number">1</span>, sort=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>

<pre><code>===concat===
            apts    cars
Shanghai   55000  200000
Beijing    60000  300000
Hangzhou   25000  150000
Najing     20000  120000
Guangzhou  30000  180000
Chongqing  10000  100000

              apts    cars
x Shanghai   55000  200000
  Beijing    60000  300000
y Hangzhou   25000  150000
  Najing     20000  120000
z Guangzhou  30000  180000
  Chongqing  10000  100000

             apts      cars     apts      cars
Shanghai  55000.0  200000.0      NaN       NaN
Beijing   60000.0  300000.0      NaN       NaN
Hangzhou      NaN       NaN  25000.0  150000.0
Najing        NaN       NaN  20000.0  120000.0</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"===append==="</span>)</span><br><span class="line">print(df1.append(df2))</span><br><span class="line">print(df1.append(df3))</span><br></pre></td></tr></table></figure>

<pre><code>===append===
           apts    cars
Shanghai  55000  200000
Beijing   60000  300000
Hangzhou  25000  150000
Najing    20000  120000
            apts    cars
Shanghai   55000  200000
Beijing    60000  300000
Guangzhou  30000  180000
Chongqing  10000  100000</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"===join==="</span>)</span><br><span class="line">print(df1.join(df4))</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line">print(df1.join(df4, how=<span class="string">'right'</span>))</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line">print(df1.join(df4, how=<span class="string">'left'</span>))</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line">print(df1.join(df4, how=<span class="string">'inner'</span>))</span><br><span class="line">print(<span class="string">""</span>)</span><br><span class="line">print(df1.join(df4, how=<span class="string">'outer'</span>))</span><br></pre></td></tr></table></figure>

<pre><code>===join===
           apts    cars  salaries cities
Shanghai  55000  200000       NaN    NaN
Beijing   60000  300000       NaN    NaN

   apts  cars  salaries     cities
0   NaN   NaN     10000     Suzhou
1   NaN   NaN     30000    Beijing
2   NaN   NaN     30000   Shanghai
3   NaN   NaN     20000  Guangzhou
4   NaN   NaN     15000    Tianjin

           apts    cars  salaries cities
Shanghai  55000  200000       NaN    NaN
Beijing   60000  300000       NaN    NaN

Empty DataFrame
Columns: [apts, cars, salaries, cities]
Index: []

             apts      cars  salaries     cities
Shanghai  55000.0  200000.0       NaN        NaN
Beijing   60000.0  300000.0       NaN        NaN
0             NaN       NaN   10000.0     Suzhou
1             NaN       NaN   30000.0    Beijing
2             NaN       NaN   30000.0   Shanghai
3             NaN       NaN   20000.0  Guangzhou
4             NaN       NaN   15000.0    Tianjin</code></pre><h2 id="groupby"><a href="#groupby" class="headerlink" title="groupby"></a>groupby</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">salaries = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">'Name'</span>: [<span class="string">'July'</span>, <span class="string">'Chu'</span>, <span class="string">'Chu'</span>, <span class="string">'Lin'</span>, <span class="string">'July'</span>, <span class="string">'July'</span>, <span class="string">'Chu'</span>, <span class="string">'July'</span>],</span><br><span class="line">    <span class="string">'Year'</span>: [<span class="number">2016</span>,<span class="number">2016</span>,<span class="number">2016</span>,<span class="number">2016</span>,<span class="number">2017</span>,<span class="number">2017</span>,<span class="number">2017</span>,<span class="number">2017</span>],</span><br><span class="line">    <span class="string">'Salary'</span>: [<span class="number">10000</span>,<span class="number">2000</span>,<span class="number">4000</span>,<span class="number">5000</span>,<span class="number">18000</span>,<span class="number">25000</span>,<span class="number">3000</span>,<span class="number">4000</span>],</span><br><span class="line">    <span class="string">'Bonus'</span>: [<span class="number">3000</span>,<span class="number">1000</span>,<span class="number">1000</span>,<span class="number">1200</span>,<span class="number">4000</span>,<span class="number">2300</span>,<span class="number">500</span>,<span class="number">1000</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">group_by_name = salaries.groupby(<span class="string">'Name'</span>)</span><br><span class="line">display(group_by_name.sum())</span><br><span class="line"></span><br><span class="line">group_by_name_year = salaries.groupby([<span class="string">'Name'</span>, <span class="string">'Year'</span>])</span><br><span class="line">display(group_by_name_year.sum())</span><br><span class="line">display(group_by_name_year.size())</span><br><span class="line">display(group_by_name_year.describe())</span><br></pre></td></tr></table></figure>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Salary</th>
      <th>Bonus</th>
    </tr>
    <tr>
      <th>Name</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Chu</th>
      <td>6049</td>
      <td>9000</td>
      <td>2500</td>
    </tr>
    <tr>
      <th>July</th>
      <td>8067</td>
      <td>57000</td>
      <td>10300</td>
    </tr>
    <tr>
      <th>Lin</th>
      <td>2016</td>
      <td>5000</td>
      <td>1200</td>
    </tr>
  </tbody>
</table>
</div>



<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Salary</th>
      <th>Bonus</th>
    </tr>
    <tr>
      <th>Name</th>
      <th>Year</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Chu</th>
      <th>2016</th>
      <td>6000</td>
      <td>2000</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>3000</td>
      <td>500</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">July</th>
      <th>2016</th>
      <td>10000</td>
      <td>3000</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>47000</td>
      <td>7300</td>
    </tr>
    <tr>
      <th>Lin</th>
      <th>2016</th>
      <td>5000</td>
      <td>1200</td>
    </tr>
  </tbody>
</table>
</div>



<pre><code>Name  Year
Chu   2016    2
      2017    1
July  2016    1
      2017    3
Lin   2016    1
dtype: int64</code></pre><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead tr th {
    text-align: left;
}

.dataframe thead tr:last-of-type th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="8" halign="left">Bonus</th>
      <th colspan="8" halign="left">Salary</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>Name</th>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Chu</th>
      <th>2016</th>
      <td>2.0</td>
      <td>1000.000000</td>
      <td>0.00000</td>
      <td>1000.0</td>
      <td>1000.0</td>
      <td>1000.0</td>
      <td>1000.0</td>
      <td>1000.0</td>
      <td>2.0</td>
      <td>3000.000000</td>
      <td>1414.213562</td>
      <td>2000.0</td>
      <td>2500.0</td>
      <td>3000.0</td>
      <td>3500.0</td>
      <td>4000.0</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>1.0</td>
      <td>500.000000</td>
      <td>NaN</td>
      <td>500.0</td>
      <td>500.0</td>
      <td>500.0</td>
      <td>500.0</td>
      <td>500.0</td>
      <td>1.0</td>
      <td>3000.000000</td>
      <td>NaN</td>
      <td>3000.0</td>
      <td>3000.0</td>
      <td>3000.0</td>
      <td>3000.0</td>
      <td>3000.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">July</th>
      <th>2016</th>
      <td>1.0</td>
      <td>3000.000000</td>
      <td>NaN</td>
      <td>3000.0</td>
      <td>3000.0</td>
      <td>3000.0</td>
      <td>3000.0</td>
      <td>3000.0</td>
      <td>1.0</td>
      <td>10000.000000</td>
      <td>NaN</td>
      <td>10000.0</td>
      <td>10000.0</td>
      <td>10000.0</td>
      <td>10000.0</td>
      <td>10000.0</td>
    </tr>
    <tr>
      <th>2017</th>
      <td>3.0</td>
      <td>2433.333333</td>
      <td>1504.43788</td>
      <td>1000.0</td>
      <td>1650.0</td>
      <td>2300.0</td>
      <td>3150.0</td>
      <td>4000.0</td>
      <td>3.0</td>
      <td>15666.666667</td>
      <td>10692.676622</td>
      <td>4000.0</td>
      <td>11000.0</td>
      <td>18000.0</td>
      <td>21500.0</td>
      <td>25000.0</td>
    </tr>
    <tr>
      <th>Lin</th>
      <th>2016</th>
      <td>1.0</td>
      <td>1200.000000</td>
      <td>NaN</td>
      <td>1200.0</td>
      <td>1200.0</td>
      <td>1200.0</td>
      <td>1200.0</td>
      <td>1200.0</td>
      <td>1.0</td>
      <td>5000.000000</td>
      <td>NaN</td>
      <td>5000.0</td>
      <td>5000.0</td>
      <td>5000.0</td>
      <td>5000.0</td>
      <td>5000.0</td>
    </tr>
  </tbody>
</table>
</div>


<blockquote>
<p>参考：</p>
</blockquote>
<ol>
<li><a href="https://www.julyedu.com/course/getDetail/66/" target="_blank" rel="noopener">廖雪峰Python数据分析</a></li>
</ol>

      
    </div>

    
      


    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/基本语法/2019/06/23/1/" rel="next" title="Python基本语法">
                <i class="fa fa-chevron-left"></i> Python基本语法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/基本语法/2019/06/24/2/" rel="prev" title="Numpy基本语法">
                Numpy基本语法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC80NDg0NS8yMTM2Ng=="></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Dan">
            
              <p class="site-author-name" itemprop="name">Dan</p>
              <div class="site-description motion-element" itemprop="description"></div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">5</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">3</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
            </nav>
          

          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <a href="https://github.com/daniel18qzx" title="GitHub &rarr; https://github.com/daniel18qzx" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <a href="https://www.linkedin.com/in/danielchiu15/" title="Linkedin &rarr; https://www.linkedin.com/in/danielchiu15/" rel="noopener" target="_blank"><i class="fa fa-fw fa-linkedin"></i></a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#基本设置"><span class="nav-number">1.</span> <span class="nav-text">基本设置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据缺失检查"><span class="nav-number">2.</span> <span class="nav-text">数据缺失检查</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Series"><span class="nav-number">3.</span> <span class="nav-text">Series</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#填充"><span class="nav-number">4.</span> <span class="nav-text">填充</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DataFrame"><span class="nav-number">5.</span> <span class="nav-text">DataFrame</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Append-Join和Concatenate"><span class="nav-number">6.</span> <span class="nav-text">Append, Join和Concatenate</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#groupby"><span class="nav-number">7.</span> <span class="nav-text">groupby</span></a></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Daniel Chiu. All Rights Reserved.</span>

  

  
</div>


  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> v3.9.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.1.2</div>




        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="post-meta-item-icon">
      <i class="fa fa-user"></i>
    </span>
    <span class="site-uv" title="Total Visitors">
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="post-meta-divider">|</span>
  

  
    <span class="post-meta-item-icon">
      <i class="fa fa-eye"></i>
    </span>
    <span class="site-pv" title="Total Views">
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=3.4.1"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/utils.js?v=7.1.2"></script>

  <script src="/js/motion.js?v=7.1.2"></script>



  
  


  <script src="/js/affix.js?v=7.1.2"></script>

  <script src="/js/schemes/pisces.js?v=7.1.2"></script>




  
  <script src="/js/scrollspy.js?v=7.1.2"></script>
<script src="/js/post-details.js?v=7.1.2"></script>



  


  <script src="/js/next-boot.js?v=7.1.2"></script>


  

  

  

  


  
    <script>
  window.livereOptions = {
    refer: '基本语法/2019/06/24/3/'
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
</script>

  


  
  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>


  

  

  

  

  

  

  

  

</body>
</html>
